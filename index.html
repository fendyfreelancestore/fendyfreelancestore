<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fendy Freelance Store</title>

<style>
:root{
  --primary:#e11d48;
  --card:rgba(2,6,23,.75);
  --text:#f1f5f9;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,Arial,sans-serif;
  color:var(--text);
  min-height:100vh;
  background:
    linear-gradient(rgba(2,6,23,.25), rgba(2,6,23,.9)),
    url("bg.jpg") center/cover no-repeat fixed;
}
header{
  display:flex;
  align-items:center;
  gap:12px;
  padding:18px 30px;
  background:rgba(2,6,23,.85);
}
header img{width:42px}

.hero{text-align:center;padding:70px 20px}
.search-box input{
  width:100%;
  max-width:420px;
  padding:14px 18px;
  border-radius:14px;
  border:none;
}

.container{padding:30px}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:22px;
}
.card{
  background:var(--card);
  border-radius:18px;
  padding:18px;
  cursor:pointer;
  transition:.3s;
}
.card:hover{transform:translateY(-5px)}
.card img{width:100%;height:140px;object-fit:contain}
.img-produk{cursor:zoom-in}
.price{color:var(--primary);font-weight:bold}
.back{grid-column:1/-1;cursor:pointer;color:#93c5fd;font-weight:600}

.btn-cart{
  margin-top:12px;
  width:100%;
  padding:14px;
  border:none;
  border-radius:16px;
  background:#facc15;
  font-weight:bold;
}
.btn-wa{
  margin-top:12px;
  width:100%;
  padding:14px;
  border:none;
  border-radius:16px;
  background:#25D366;
  font-weight:bold;
}

/* CART */
.cart-float{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#25D366;
  color:#000;
  padding:14px 18px;
  border-radius:50px;
  font-weight:bold;
  cursor:pointer;
  z-index:999;
}
.cart-box{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  z-index:9999;
}
.cart-content{
  background:#020617;
  max-width:420px;
  margin:60px auto;
  padding:20px;
  border-radius:18px;
}
.cart-item{
  display:flex;
  justify-content:space-between;
  margin:8px 0;
}
.cart-total{margin-top:14px;font-weight:bold}

/* ZOOM */
.zoom{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.zoom img{max-width:95%;max-height:95%}

/* FOOTER */
footer{
  text-align:center;
  padding:20px 10px;
  font-size:14px;
  color:#cbd5f5;
  background:rgba(2,6,23,.85);
}
</style>
</head>

<body>

<header>
  <img src="logo.png">
  <h3>Fendy Freelance Store</h3>
</header>

<section class="hero">
  <h2>SELAMAT DATANG</h2>
  <p>Komputer â€¢ Laptop â€¢ CCTV â€¢ Smartphone</p>
  <div class="search-box">
    <input id="search" placeholder="Cari produk... (contoh: laptop axioo)">
  </div>
</section>

<section class="container">
  <h2 id="judul">Kategori Produk</h2>
  <div id="view" class="grid"></div>
</section>

<!-- CART -->
<div class="cart-float" onclick="openCart()">
  ðŸ›’ Keranjang (<span id="cartCount">0</span>)
</div>

<div class="cart-box" id="cartBox">
  <div class="cart-content">
    <h3>Keranjang Belanja</h3>
    <div id="cartList"></div>
    <div class="cart-total" id="cartTotal"></div>
    <button class="btn-wa" onclick="checkoutWA()">Kirim Total ke WhatsApp</button>
    <button class="btn-wa" style="background:#64748b" onclick="closeCart()">Tutup</button>
  </div>
</div>

<div class="zoom" id="zoom"><img id="zoomImg"></div>

<footer>Â© 2026 Fendy Freelance Store</footer>

<script>
let kategori=[], brand=[], produk=[], cart=[];
const view=document.getElementById("view");
const judul=document.getElementById("judul");
const zoom=document.getElementById("zoom");
const zoomImg=document.getElementById("zoomImg");

/* NAV STATE */
let nav={level:"kategori",kategori:null,brand:null,scroll:0};
function saveScroll(){nav.scroll=window.scrollY}
function restoreScroll(){
  setTimeout(()=>window.scrollTo({top:nav.scroll,behavior:"auto"}),0);
}

/* LOAD CSV */
fetch("kategori.csv").then(r=>r.text()).then(t=>{
  kategori=t.trim().split("\n").slice(1).map(r=>{
    const [id,nama,desk,foto]=r.split(",");
    return {id,nama,desk,foto};
  });
  tampilKategori();
});
fetch("brand.csv").then(r=>r.text()).then(t=>{
  brand=t.trim().split("\n").slice(1).map(r=>{
    const [id,nama,kategori,foto]=r.split(",");
    return {id,nama,kategori,foto};
  });
});
fetch("produk.csv").then(r=>r.text()).then(t=>{
  produk=t.trim().split("\n").slice(1).map(r=>{
    const [id,nama,harga,brand,foto,wa,spek]=r.split(",");
    return {id,nama,harga,brand,foto,wa,spek};
  });
});

/* VIEW */
function tampilKategori(){
  nav.level="kategori";
  judul.innerText="Kategori Produk";
  view.innerHTML="";
  kategori.forEach(k=>{
    view.innerHTML+=`
      <div class="card" onclick="saveScroll();nav.kategori='${k.id}';tampilBrand('${k.id}','${k.nama}')">
        <img src="${k.foto}">
        <h3>${k.nama}</h3>
        <p>${k.desk}</p>
      </div>`;
  });
  restoreScroll();
}

function tampilBrand(id,nama){
  nav.level="brand";
  judul.innerText=nama;
  view.innerHTML=`<div class="back" onclick="navBack()">â¬… Kembali</div>`;
  brand.filter(b=>b.kategori===id).forEach(b=>{
    view.innerHTML+=`
      <div class="card" onclick="saveScroll();nav.brand='${b.id}';tampilProduk('${b.id}','${b.nama}')">
        <img src="${b.foto}">
        <h3>${b.nama}</h3>
      </div>`;
  });
  restoreScroll();
}

function tampilProduk(id,nama){
  nav.level="produk";
  judul.innerText=nama;
  view.innerHTML=`<div class="back" onclick="navBack()">â¬… Kembali</div>`;
  produk.filter(p=>p.brand===id).forEach(p=>{
    view.innerHTML+=`
      <div class="card" onclick="tampilDetail('${p.id}')">
        <img src="${p.foto}" class="img-produk">
        <h3>${p.nama}</h3>
        <div class="price">Rp ${Number(p.harga).toLocaleString("id-ID")}</div>
      </div>`;
  });
  restoreScroll();
}

function tampilDetail(id){
  saveScroll();
  nav.level="detail";
  const p=produk.find(x=>x.id===id);
  judul.innerText=p.nama;
  view.innerHTML=`
    <div class="back" onclick="navBack()">â¬… Kembali</div>
    <div class="card">
      <img src="${p.foto}" class="img-produk">
      <h2>${p.nama}</h2>
      <div class="price">Rp ${Number(p.harga).toLocaleString("id-ID")}</div>
      <ul>${p.spek.split(";").map(s=>`<li>${s}</li>`).join("")}</ul>
      <button class="btn-cart" onclick='addCart(${JSON.stringify(p)})'>+ Tambah ke Keranjang</button>
    </div>`;
}

/* NAV BACK */
function navBack(){
  if(nav.level==="detail") tampilProduk(nav.brand,"");
  else if(nav.level==="produk") tampilBrand(nav.kategori,"");
  else tampilKategori();
}

/* CART */
function addCart(p){
  const i=cart.find(x=>x.id===p.id);
  i?i.qty++:cart.push({...p,qty:1});
  cartCount.innerText=cart.reduce((a,b)=>a+b.qty,0);
}
function openCart(){cartBox.style.display="block"}
function closeCart(){cartBox.style.display="none"}
function checkoutWA(){}

/* SEARCH */
search.oninput=function(){
  const k=this.value.toLowerCase();
  if(k.length<2) return tampilKategori();
  judul.innerText="Hasil Pencarian";
  view.innerHTML="";
  produk.filter(p=>p.nama.toLowerCase().includes(k)).forEach(p=>{
    view.innerHTML+=`
      <div class="card" onclick="tampilDetail('${p.id}')">
        <img src="${p.foto}" class="img-produk">
        <h3>${p.nama}</h3>
      </div>`;
  });
};

/* ZOOM */
function zoomFoto(src){
  zoomImg.src=src;
  zoom.style.display="flex";
}
zoom.onclick=()=>zoom.style.display="none";

/* ================================================= */
/* ===== FIX FOTO PRODUK (PC & MOBILE, TANPA UBAH HTML) ===== */
document.addEventListener("click",function(e){
  const img=e.target.closest(".img-produk");
  if(!img) return;
  e.preventDefault();
  e.stopPropagation();
  e.stopImmediatePropagation();
  zoomFoto(img.src);
},true);

document.addEventListener("touchstart",function(e){
  const img=e.target.closest(".img-produk");
  if(!img) return;
  e.preventDefault();
  e.stopPropagation();
  e.stopImmediatePropagation();
  zoomFoto(img.src);
},{capture:true,passive:false});
</script>

</body>
</html>